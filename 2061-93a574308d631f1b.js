"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2061],{32061:function(e,t,n){n.r(t),n.d(t,{ChatInbox:function(){return e2},ChatMessageChain:function(){return nT},ChatProductMessages:function(){return nO}});var r,o,a,i,l,c,u,s,d,m,f,p,h,g,v,x,y,b,E,w,Z,k,R,C,I,P,S,L,F,T,N,O,z,A,D,M,j,_,W,H,G,K,U=n(7896),J=n(2784),B=n(87043),q=n(5632),V=n.n(q),$=n(6422),Y=n(89382),X=n(57508),Q=n(87333),ee=n(76854),et=n(54073),en=n.n(et),er=n(76613),eo=n(34490),ea=n(71171),ei=n(99673),el=n(55403),ec=ei.ZP.div(r||(r=(0,ea.Z)(["\n  position: absolute;\n  background-color: #fff;\n  border-radius: 50%;\n  box-shadow: ",";\n  left: 50%;\n  transform: translateX(-50%);\n  width: 40px;\n  height: 40px;\n  padding: 4px;\n\n  ","\n\n  ","\n\n  ","\n"])),(0,el.R)("boxShadows.1"),function(e){return"top"===e.align&&(0,ei.iv)(o||(o=(0,ea.Z)(["\n      top: 8px;\n    "])))},function(e){return"bottom"===e.align&&(0,ei.iv)(a||(a=(0,ea.Z)(["\n      bottom: 8px;\n    "])))},function(e){return"center"===e.align&&(0,ei.iv)(i||(i=(0,ea.Z)(["\n      top: 50%;\n      transform: translate(-50%, -50%);\n    "])))}),eu=function(e){var t=e.align;return J.createElement(ec,{align:t,"data-testid":"chat-loading"},J.createElement(eo.JO$,{name:"AnimatedLoading3",width:32,height:32}))};eu.defaultProps={align:"bottom"};var es=function(e){var t=e.onRetry;return J.createElement(B.kC,{flexDirection:"column",justifyContent:"space-around","data-testid":"ConnErrorState-Root"},J.createElement(B.xu,null,J.createElement(B.Ee,{title:"Imagem ilustrativa - Conex\xe3o remota com falha",alt:"Imagem ilustrativa - Conex\xe3o remota com falha",width:"100%",height:"50vh",src:"https://wx.mlcdn.com.br/site/chat/cable-disconnected-colorful.svg"})),J.createElement(B.xu,{textAlign:"center",p:"2",role:"alert","aria-live":"assertive"},J.createElement(B.xv,{fontSize:6,fontWeight:"bold",mb:4},"Erro inesperado"),J.createElement(B.xv,{fontSize:2},"Isso pode ocorrer por uma instabilidade ou problema de conex\xe3o tempor\xe1ria.")),J.createElement(B.xu,{textAlign:"center",p:"2"},J.createElement(B.xv,{fontSize:2,mb:3},"Por favor, aguarde alguns instantes e tente novamente."),J.createElement(B.zx,{full:!0,centered:!0,onClick:t,size:"large",uppercase:!1},"Tentar novamente")))},ed=(0,J.memo)(es),em=n(59740),ef=n(86522),ep=n(36631),eh=n(6738),eg=n(36076),ev=n(34291),ex=n.n(ev),ey=n(76635),eb=n(56666),eE=function(e){var t,n=(0,J.useRef)({}),r=function(t,r){var o=r.elementRef.offsetHeight,a=r.windowWidth,i=r.id;n.current=(0,U.Z)({},n.current,(0,eb.Z)({},i,{height:o,id:i,windowWidth:a})),e.current.resetAfterIndex(t)},o=function(e,t){var o=n.current[t.id],a=t.windowWidth!==o.windowWidth,i=t.elementRef.offsetHeight!==o.height;(a||i)&&r(e,t)};return[function(e){return n.current[e]?n.current[e].height:0},(0,J.useCallback)(function(t,a){e.current&&a&&(n.current[a.id]?o(t,a):r(t,a))},[e.current])]},ew=function(e){var t=(0,J.useRef)(),n=e.data,r=e.index,o=e.id,a=e.onSetSize,i=e.windowWidth,l=n.renderRow;return(0,J.useEffect)(function(){a(r,{elementRef:t.current,id:o,windowWidth:i})},[a,i,r]),J.createElement("div",{ref:t},l(r))};ew.defaultProps={onSetSize:ex()},ew.ssr=!1;var eZ=(0,J.memo)(ew),ek=["renderRow","listRef","onScroll"],eR=(0,ep.Z)(function(e){return{renderRow:e}}),eC=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach(function(t){"function"==typeof t&&t(e),"object"===(0,ef.Z)(t)&&(t.current=e)})}},eI=function(e){var t=e.renderRow,n=e.listRef,r=e.onScroll,o=(0,em.Z)(e,ek),a=(0,J.useRef)(),i=eE(a),l=(0,ee.Z)(i,2),c=l[0],u=l[1],s=eR(t),d=(0,J.useCallback)(function(e,t){Object.prototype.hasOwnProperty.call(o,"itemSize")||u(e,t)},[]),m=function(e){var t;return"liid:".concat(null!==(t=o.itemKey(e))&&void 0!==t?t:e)},f=function(e){var t;return"likey:".concat(null!==(t=o.itemKey(e))&&void 0!==t?t:e)},p=(0,ey.debounce)(function(e){var t;return J.createElement(eg.S_,(0,U.Z)({ref:eC(n,a),itemData:s,width:e.width,height:e.height,itemSize:function(e){var t=m(e);return c(t,e)},onScroll:function(t){null==r||r(t,e)}},o,{itemKey:f}),function(t){var n=t.data,r=t.index,o=t.style,a=m(r);return J.createElement("div",{style:o,key:a},J.createElement(eZ,{id:a,data:n,index:r,onSetSize:d,windowWidth:e.width}))})},10,{leading:!0,trailing:!0});return J.createElement(eh.ZP,null,p)};eI.defaultProps={itemKey:ex(),listRef:ex(),onScroll:ex()},eI.ssr=!1;var eP=(0,J.memo)(eI),eS={makeHandleScroll:function(e,t){var n=e.loading,r=e.onLoadPreviousItems,o=e.onLoadNextItems,a=e.hasPreviousItems,i=e.hasNextItems,l=en()(function(){return null==r?void 0:r()},100),c=en()(function(){return null==o?void 0:o()},100);return function(e,r){var o=e.scrollOffset,u=e.scrollDirection,s=r.height;!n&&(!function(){var e;a&&"backward"===u&&t.current&&o<60&&l()}(),function(){var e;i&&"forward"===u&&t.current&&t.current.scrollHeight-s-60<o&&c()}())}}},eL=["loading","onLoadPreviousItems","onLoadNextItems","hasPreviousItems","hasNextItems"],eF=function(e){e.loading,e.onLoadPreviousItems,e.onLoadNextItems,e.hasPreviousItems,e.hasNextItems;var t=(0,em.Z)(e,eL),n=(0,J.useRef)(),r=eS.makeHandleScroll(e,n);return J.createElement(eP,(0,U.Z)({},t,{onScroll:r,innerRef:n}))};eF.defaultProps={hasNextItems:void 0,hasPreviousItems:void 0,loading:void 0,onLoadNextItems:void 0,onLoadPreviousItems:void 0},eF.ssr=!1;var eT=(0,J.memo)(eF),eN=(0,ei.ZP)(B.xu).attrs(function(e){return(0,U.Z)({flex:"1 1 auto",height:"100%",minHeight:0,overflow:"hidden",position:"relative",width:"100%"},e)})(l||(l=(0,ea.Z)([""]))),eO=n(27439),ez=n(19527),eA=n(97851),eD=ei.ZP.div(c||(c=(0,ea.Z)(["\n  > div > button > div {\n    height: 20px;\n    width: auto;\n    min-width: 20px;\n    border-radius: 10px;\n    top: 0;\n    bottom: auto;\n    z-index: 1;\n    transform-origin: 100% 0%;\n    transform: scale(1) translate(35%, -35%);\n  }\n"]))),eM=(0,ei.ZP)(eO.ZP)(u||(u=(0,ea.Z)(["\n  display: flex;\n  border-radius: 0;\n  border-bottom: 1px solid ",";\n"])),(0,el.R)("colors.lightSilver")),ej=(0,ei.ZP)(eO.ZP.Subtitle)(s||(s=(0,ea.Z)(["\n  white-space: nowrap;\n"]))),e_=function(e){var t=e.name,n=e.description,r=e.date,o=e.onClick,a=e.badgeCount;return J.createElement(eM,{onClick:o,"data-testid":"chat-contact-card"},J.createElement(ez.Z,{flexDirection:"row",gap:3,alignItems:"center",width:"100%",padding:"16px 20px"},J.createElement(eD,null,J.createElement(eA.Z,{amount:a,backgroundColor:"transparent",counterColor:"#0086ff",fontColor:"#fff",truncateAmountThreshold:10,nullable:!1},J.createElement(eo.JO$,{name:"SellerStore",width:40,height:40}))),J.createElement(ez.Z,{justifyContent:"space-between",gap:2,flex:1},J.createElement("div",null,J.createElement(eO.ZP.Subtitle,{"data-testid":"chat-contact-card-name",fontSize:"1rem",lineHeight:"1.125rem",fontWeight:500,lines:1,marginTop:0,truncate:!0},t),n&&J.createElement(eO.ZP.Subtitle,{color:"scratched",fontSize:"0.875rem",fontWeight:400,lineHeight:"1rem",lines:1,marginTop:1,truncate:!0},n)),r&&J.createElement(ej,{color:"scratched",fontWeight:400,marginTop:0,whiteSpace:"nowrap"},r))))};e_.defaultProps={badgeCount:0,date:void 0,description:void 0};var eW=(0,J.memo)(e_),eH=ei.ZP.span(d||(d=(0,ea.Z)(["\n  position: relative;\n"]))),eG=ei.ZP.span(m||(m=(0,ea.Z)(["\n  position: absolute;\n  width: 30px;\n  height: 30px;\n  background-color: ",";\n  border-radius: ",";\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  right: 0;\n"])),function(e){return(0,el.dF)("primary")(e)},(0,el.R)("radii.circle")),eK=function(e){return J.createElement(B.kC,(0,U.Z)({},e,{flexDirection:"column",justifyContent:"center","data-testid":"EmptyState-Root"}),J.createElement(B.xu,{textAlign:"center"},J.createElement(eH,null,J.createElement(eo.JO$,{name:"SellerStore",height:"104px",width:"104px"}),J.createElement(eG,{title:"N\xfamero de conversas: 0"},J.createElement(B.xv,{color:"text.white",fontWeight:"bold"},"0")))),J.createElement(B.xu,{textAlign:"center",p:"2"},J.createElement(B.xv,{fontSize:5,lineHeight:"big",fontWeight:"bold",mb:4},"Voc\xea ainda n\xe3o tem conversas com lojistas")))},eU=(0,J.memo)(eK),eJ=(0,ei.ZP)(eU)(f||(f=(0,ea.Z)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n"]))),eB=["items","onClickItem","onLoadNextItems","hasNextItems","loading"],eq=function(e){var t=e.items,n=e.onClickItem,r=e.onLoadNextItems,o=e.hasNextItems,a=e.loading,i=(0,em.Z)(e,eB),l=t.length,c=function(){return 69},u=function(e){var r,o=t[e];return J.createElement(eW,{name:o.toUser.fullName,description:null==o?void 0:null==(r=o.lastMessage)?void 0:r.content,date:o.lastInteractionAt,onClick:function(){return n(o,e)},badgeCount:o.unreadFromCount})};return J.createElement(eN,(0,U.Z)({"data-testid":"chat-conversation-list"},i,{bg:"background.white"}),J.createElement(eT,{itemCount:l,itemSize:c,renderRow:u,onLoadNextItems:r,hasNextItems:o,loading:a}),0===l&&J.createElement(eJ,null),a&&J.createElement(eu,null))};eq.defaultProps={hasNextItems:void 0,loading:void 0,onLoadNextItems:void 0},eq.ssr=!1;var eV=(0,J.memo)(eq),e$=n(90749),eY=(0,ei.ZP)(B.kC).attrs(function(e){return(0,U.Z)({flexDirection:"column",fontFamily:'"MagaluTextos", sans-serif',height:"100%",width:"100%"},e)})(p||(p=(0,ea.Z)([""]))),eX=(0,ei.ZP)(e$.HS)(h||(h=(0,ea.Z)(["\n  border-radius: 12px;\n  margin: 8px 8px 32px 8px;\n  border: none;\n\n  & div {\n    height: 48px;\n  }\n\n  div & :focus {\n    outline: 1px solid ",";\n  }\n"])),(0,el.dF)("opacityBlue")),eQ=function(e){var t=e.onClickItem,n=e.userData,r=e.staticProps,o=n.id,a=(0,J.useState)(""),i=(0,ee.Z)(a,2),l=i[0],c=i[1],u=(0,er.useChatConversations)({search:l,staticProps:r,userId:o}),s=u.items,d=u.loading,m=u.error,f=u.hasNextPage,p=u.fetchNextPage,h=u.fetchMore,g=u.refetch;(0,J.useEffect)(function(){h()},[l]);var v=function(e){c(e.target.value)},x=function(){c("")},y=en()(v,500);return m?J.createElement(ed,{onRetry:g}):J.createElement(eY,{bg:"background.base"},J.createElement(eX,{label:"lojista",onChange:y,onClearInput:x}),!s&&d&&J.createElement(eu,{align:"center"}),s&&J.createElement(eV,{loading:d,items:s,onClickItem:t,hasNextItems:f,onLoadNextItems:p}))},e0=(0,J.memo)(eQ),e1=function(e){var t=e.structure,n=e.static,r=t.route,o=(0,X.Cv)({structure:t}),a=o.data,i=o.loading,l=(0,Q.Np)().publish,c=!!(null==r?void 0:r.sellerId);(0,J.useEffect)(function(){if(c){var e="/chat-com-lojista/p/".concat(r.sellerId,"/").concat((null==r?void 0:r.productId)?r.productId:"");V().replace(e)}},[]),(0,J.useEffect)(function(){if(a){var e,n;l("sellerchat:inbox:conversations:onview",{userId:a.id,userIsLogged:a.isLogged,userLocation:(0,U.Z)({},null==t?void 0:null==(e=t.cookies)?void 0:e.location,{zipCode:null==t?void 0:null==(n=t.cookies)?void 0:n.zipCode})})}},[a]);var u=function(e){var t;l("sellerchat:inbox:conversations:onclick",{sellerId:e.toUser.refKey,userId:a.id}),(0,$.dY)({path:"/chat-com-lojista/p/".concat(null==(t=e.toUser)?void 0:t.refKey,"/"),spa:!0})};return c||i?J.createElement(B.SX,null):(null==a?void 0:a.isLogged)?J.createElement(e0,{onClickItem:u,userData:a,staticProps:n}):J.createElement(B.kC,{width:"100%",justifyContent:"center",alignItems:"center"},J.createElement(B.xv,null,"Usu\xe1rio n\xe3o autorizado"))};e1.defaultProps={static:{},structure:{}},e1.ssr=!0;var e2=(0,Y.Z)(e1),e3=n(34795),e4=ei.ZP.div(g||(g=(0,ea.Z)(["\n  border-radius: ",";\n  width: 48px;\n  height: 48px;\n  color: ",";\n  text-align: center;\n"])),function(e){return(0,el.R)("radii.circle")(e)},function(e){return(0,el.dF)("white")(e)}),e6=ei.ZP.button(v||(v=(0,ea.Z)(["\n  padding: ","px ","px;\n  min-width: 0;\n  border-radius: ",";\n  white-space: nowrap;\n  background-color: ",";\n  color: ",";\n  border-color: ",";\n  font-size: 14px;\n  font-weight: ",";\n  height: 33px;\n  display: flex;\n  align-items: center;\n  border: ",";\n\n  label {\n    text-transform: none;\n  }\n"])),(0,el.R)("space.1"),(0,el.R)("space.3"),(0,el.R)("radii.default"),function(e){return(null==e?void 0:e.follow)?"#edf8ff":(0,el.dF)("white")(e)},(0,el.R)("palette.primary.base"),(0,el.R)("palette.primary.base"),(0,el.R)("fontWeights.medium"),function(e){return(null==e?void 0:e.follow)?"0px":"1px solid"}),e5=ei.ZP.header(x||(x=(0,ea.Z)(["\n  width: 100%;\n  display: flex;\n  height: 64px;\n  background-color: ",";\n  align-items: center;\n  justify-content: space-between;\n  padding: ","px ","px;\n\n  & span {\n    margin-left: ","px;\n    font-size: ","px;\n    font-weight: ",";\n  }\n"])),function(e){return(0,el.dF)("white")(e)},(0,el.R)("space.2"),(0,el.R)("space.3"),(0,el.R)("space.2"),(0,el.R)("fontSizes.3"),(0,el.R)("fontWeights.medium")),e8=ei.ZP.div(y||(y=(0,ea.Z)(["\n  justify-content: flex-end;\n"]))),e7=ei.ZP.div(b||(b=(0,ea.Z)(["\n  justify-content: flex-start;\n  display: flex;\n  align-items: center;\n"]))),e9=ei.ZP.div(E||(E=(0,ea.Z)(["\n  padding-right: 2px;\n  display: flex;\n  align-items: center;\n"])));function te(){te=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(s){u=function(e,t,n){return e[t]=n}}function d(t,n,r,a){var i,l,c,u,s=Object.create((n&&n.prototype instanceof v?n:v).prototype);return o(s,"_invoke",{value:(i=t,l=r,c=new S(a||[]),u=f,function(t,n){if(u===p)throw Error("Generator is already running");if(u===h){if("throw"===t)throw n;return{value:e,done:!0}}for(c.method=t,c.arg=n;;){var r=c.delegate;if(r){var o=C(r,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(u===f)throw u=h,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);u=p;var a=m(i,l,c);if("normal"===a.type){if(u=c.done?h:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(u=h,c.method="throw",c.arg=a.arg)}})}),s}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=d;var f="suspendedStart",p="executing",h="completed",g={};function v(){}function x(){}function y(){}var b={};u(b,i,function(){return this});var E=Object.getPrototypeOf,w=E&&E(E(L([])));w&&w!==n&&r.call(w,i)&&(b=w);var Z=y.prototype=v.prototype=Object.create(b);function k(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function R(e,t){var n;o(this,"_invoke",{value:function(o,a){function i(){return new t(function(n,i){!function n(o,a,i,l){var c=m(e[o],e,a);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==(0,ef.Z)(s)&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,l)},function(e){n("throw",e,i,l)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,l)})}l(c.arg)}(o,a,n,i)})}return n=n?n.then(i,i):i()}})}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError((0,ef.Z)(t)+" is not iterable")}return x.prototype=y,o(Z,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:x,configurable:!0}),x.displayName=u(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,c,"GeneratorFunction")),e.prototype=Object.create(Z),e},t.awrap=function(e){return{__await:e}},k(R.prototype),u(R.prototype,l,function(){return this}),t.AsyncIterator=R,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new R(d(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},k(Z),u(Z,c,"Generator"),u(Z,i,function(){return this}),u(Z,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var tt=function(e){var t,n=e.label,r=e.avatarIcon,o=e.customerFollower,a=J.useState({buttonLabel:o.isFollowing?"Seguindo":"Seguir",isFollowing:o.isFollowing}),i=(0,ee.Z)(a,2),l=i[0],c=i[1],u=(0,er.useChatSetFollowStatus)().fetchSetFollower,s=(0,Q.Np)().publish,d=(t=(0,e3.Z)(te().mark(function e(){var t;return te().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({customerId:o.customerId,followSeller:!l.isFollowing,sellerId:o.sellerId});case 2:c({buttonLabel:(t=e.sent).isFollowing?"Seguindo":"Seguir",isFollowing:t.isFollowing}),s("chat-conversation:followSeller:click",{isFollowing:t.isFollowing,sellerId:o.sellerId});case 5:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});return J.createElement(e5,{"data-testid":"chat-conversation-header-root"},J.createElement(e7,null,J.createElement(e4,null,J.createElement(eo.JO$,{name:r,color:"background.primary",width:48,height:48})),J.createElement("span",{"data-testid":"chat-conversation-header-title"},n)),J.createElement(e8,null,J.createElement(e6,{follow:l.isFollowing,variant:"contained",onClick:d},l.isFollowing?J.createElement(eo.yR2,{color:"background.primary",width:20,height:20}):J.createElement(e9,null,J.createElement(eo.kjA,{color:"background.primary",width:12,height:20})),l.buttonLabel)))};tt.defaultProps={customerFollower:{customerId:"",isFollowing:!1,sellerId:""}};var tn=ei.ZP.div(w||(w=(0,ea.Z)(["\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  align-items: center;\n  gap: ",";\n  padding: 8px 4px 16px 4px;\n\n  > hr {\n    flex: 1;\n    margin: 0;\n    height: 0px;\n    border-width: 1px 0 0 0;\n    border-color: ",";\n  }\n\n  > span {\n    color: ",";\n    font-weight: ",";\n    font-size: ","px;\n    line-height: ","px;\n    background-color: ",";\n    border-radius: ",";\n    padding: 4px 16px;\n    flex: none;\n    flex-grow: 0;\n  }\n"])),function(e){return(0,el.R)("space.2")(e)},function(e){return(0,el.ow)("text.white")(e)},function(e){return(0,el.ow)("text.white")(e)},(0,el.R)("fontWeights.medium"),(0,el.R)("fontSizes.2"),(0,el.R)("lineHeights.tall"),function(e){return(0,el.R)("colors.gray")(e)},function(e){return(0,el.R)("radii.big")(e)}),tr=["children"],to=function(){return 50},ta=function(e){var t=e.children,n=(0,em.Z)(e,tr);return J.createElement(tn,(0,U.Z)({"data-testid":"chat-date-message"},n),J.createElement("hr",null),J.createElement("span",null,t),J.createElement("hr",null))};ta.getHeight=to;var ti=(0,el.R)("radii.default"),tl="64px",tc=(0,ei.ZP)("span")(Z||(Z=(0,ea.Z)(["\n  line-height: normal;\n  margin-top: 5px;\n  background: ",";\n  border-radius: 50%;\n  width: 10px;\n  height: 10px;\n  display: block;\n  text-align: center;\n  font-size: 8px;\n  flex: none;\n  color: ",";\n"])),function(e){return(0,el.R)("palette.alert.danger.text")(e)},function(e){return(0,el.R)("palette.alert.danger.base")(e)}),tu=(0,ei.ZP)("form")(k||(k=(0,ea.Z)(["\n  padding: ","px ","px ","px\n    ","px;\n  box-shadow: ",";\n"])),(0,el.R)("space.2"),(0,el.R)("space.1"),(0,el.R)("space.1"),(0,el.R)("space.1"),(0,el.R)("boxShadows.4")),ts=(0,ei.ZP)(B.zx)(R||(R=(0,ea.Z)(["\n  color: ",";\n  background-color: ",";\n  padding: 0;\n  min-width: 48px;\n  height: inherit;\n  min-height: ",";\n  border-radius: 0px "," "," 0px;\n  border: ","!important;\n  border-left: none !important;\n  :disabled {\n    opacity: 0.7;\n    background-color: ",";\n    color: ",";\n    min-height: ",";\n  }\n  &:focus {\n    background-color: ",";\n    outline: 1px solid ",";\n    outline-offset: -3px;\n  }\n  svg {\n    fill: ",";\n  }\n"])),(0,el.uu)("primary"),(0,el.dF)("white"),tl,ti,ti,(0,el.R)("borders.0"),(0,el.dF)("base"),(0,el.uu)("gray"),tl,(0,el.dF)("base"),(0,el.dF)("opacityBlue"),function(e){return(0,el.uu)(e.disabled?"gray":"primary")(e)}),td=(0,ei.ZP)(B.II)(C||(C=(0,ea.Z)(["\n  min-height: ",";\n  max-height: 20vh;\n  border-radius: "," 0px 0px ",";\n  border: ",";\n  border-right: none;\n  font-size: ","px;\n  font-style: normal;\n  font-weight: ",";\n  line-height: ",";\n  flex-grow: 1;\n  padding: ","px;\n  &:focus {\n    background-color: ",";\n    outline: 1px solid ",";\n    outline-offset: -3px;\n  }\n"])),tl,ti,ti,(0,el.R)("borders.0"),(0,el.R)("fontSizes.3"),(0,el.R)("fontWeights.regular"),(0,el.R)("lineHeights.input"),(0,el.R)("space.2"),(0,el.dF)("base"),(0,el.dF)("opacityBlue")),tm=(0,ei.ZP)(B.kC)(I||(I=(0,ea.Z)(["\n  justify-items: stretch;\n"]))),tf=(0,ei.ZP)(B.xu)(P||(P=(0,ea.Z)(["\n  border-radius: 0px 0px "," ",";\n  border: ",";\n  padding: ","px;\n  margin: 4px 0 0 0;\n  background-color: ",";\n  border-color: #f1aeb5;\n  display: flex;\n  gap: ","px;\n"])),ti,ti,(0,el.R)("borders.0"),(0,el.R)("space.1"),function(e){return(0,el.R)("palette.alert.danger.base")(e)},(0,el.R)("space.1")),tp=function(e){var t=e.ref;function n(){if(t&&t.current){var e=t.current,n=e.clientHeight;e.style.height="inherit";var r=Math.max(n,e.scrollHeight);e.style.height="".concat(r,"px")}}return(0,J.useEffect)(n),{resetHeightTextarea:function(){t&&t.current&&(t.current.focus(),t.current.style.height="initial")},resizeTextarea:n}},th=function(e){var t=e.target.value,n=e.target.selectionStart;return"".concat(t.slice(0,n),"\n").concat(t.slice(n))},tg=function(e){var t=e.handleOnSubmit,n=e.inputRef,r=(0,J.useState)(""),o=(0,ee.Z)(r,2),a=o[0],i=o[1],l=tp({ref:n}).resetHeightTextarea,c=(0,J.useMemo)(function(){return a.trim().length>0&&null===a.match(/^[^a-zA-Z0-9]+$/)},[a]),u=function(e){e.preventDefault(),c&&(t({message:a.trim(),ref:{resetForm:function(){i("")}}}),n.current.focus(),l())};return{handleChangeEvent:function(e){i(e.target.value)},handleKeyDownEvent:function(e){"Enter"!==e.code||e.shiftKey||"Enter"!==e.code||e.ctrlKey||u(e)},handleKeyPressEvent:function(e){if("Enter"===e.code&&e.shiftKey||"Enter"===e.code&&e.ctrlKey){e.preventDefault();var t=th(e);i(t)}},handleSubmitEvent:u,isValid:c,value:a}},tv=function(e){var t=e.onSubmit,n=e.loading,r=e.error,o=(0,J.useRef)(),a=tg({handleOnSubmit:t,inputRef:o}),i=a.handleChangeEvent,l=a.handleSubmitEvent,c=a.handleKeyDownEvent,u=a.handleKeyPressEvent,s=a.isValid,d=a.value,m=(0,J.useMemo)(function(){return n?"AnimatedLoading3":"Send"},[n]);return J.createElement(tu,{onSubmit:l,"aria-keyshortcuts":"Enter"},J.createElement(tm,null,J.createElement(td,{style:{borderBottomLeftRadius:r?0:"6px"},"aria-required":"true","aria-errormessage":"message-form-error","aria-invalid":!1===s,value:d,ref:o,onKeyPress:u,onKeyDown:c,onChange:i,multiline:!0,rows:1,fullWidth:!0,autocomplete:"off",tabindex:0,spellcheck:"true",placeholder:"Digite uma mensagem..."}),J.createElement(ts,{style:{borderBottomRightRadius:r?0:"6px !important"},"aria-label":"Enviar mensagem",type:"submit",tabindex:0,disabled:!s,outline:!0,centered:!0,variant:"contained",color:"default",size:"large"},J.createElement(eo.JO$,{name:m,"data-icon-name":m,width:32,height:32}))),J.createElement(tf,{bg:"alerts.danger-base",style:{display:r?"flex":"none"}},J.createElement(tc,{color:"error",fontSize:"1",fontWeight:"bold","data-testid":"error-icon"},"!"),J.createElement(B.xv,{"aria-label":r,color:"error",id:"message-form-error",fontSize:"1",lineHeight:"150%",role:"alert",ml:"1"},r)))};tv.defaultProps={error:"",loading:!1};var tx=ei.ZP.li(S||(S=(0,ea.Z)(["\n  &:focus {\n    outline: 2px solid ",";\n    outline-offset: 2px;\n  }\n"])),(0,el.dF)("opacityBlue")),ty=(0,ei.ZP)(B.kC)(L||(L=(0,ea.Z)(["\n  height: 100%;\n"]))),tb=function(e,t){var n,r=e.length;if(0===r)return -1;var o=r-t.itemCount;return 0===o?-1:e[r-1].id===(null==(n=t.lastItem)?void 0:n.id)?o:99999},tE=function(e){var t=e.messages,n=t.length,r=(0,J.useRef)(!1),o=(0,J.useRef)(null),a=(0,J.useRef)({itemCount:0}),i=(0,J.useState)({index:0}),l=(0,ee.Z)(i,2),c=l[0],u=l[1];return(0,J.useLayoutEffect)(function(){if(o.current){var e=tb(t,a.current);e>1&&(o.current.resetAfterIndex(0,!0),u({index:e}))}return function(){a.current={itemCount:n,lastItem:t[n-1]}}},[t,o,n]),(0,J.useLayoutEffect)(function(){var e;null==o||null==(e=o.current)||e.scrollToItem(c.index,"start")},[o,c]),{setInfiniteListRef:function(e){return o.current=e,!1===r.current&&e&&(r.current=!0,e.scrollToItem(99999)),e}}},tw=n(63825),tZ=n(74930),tk=n.n(tZ),tR=function(e){var t=e.text,n=t.match(/https?:\/\/\S+/g);return n?t.split(/(https?:\/\/\S+)/g).map(function(e){return n.includes(e)?J.createElement("a",{"data-testid":"chat-message-link",className:"chat-message-link",key:tk()("chat-message-link-"),href:e,rel:"noopener noreferrer"},e):e}):t};tR.defaultProps={text:""};var tC=(0,J.memo)(tR),tI={alertDangerBase:"palette.alert.danger.base",gray:"colors.gray",textAttributeLabel:"palette.text.attributeLabel",textWhite:"palette.text.white"},tP={center:"center",left:"flex-start",right:"flex-end"},tS={alert:{background:tI.alertDangerBase,text:tI.textAttributeLabel},error:{background:tI.alertDangerBase,text:tI.textAttributeLabel},gray:{background:tI.gray,text:tI.textWhite},primary:{background:"palette.primary.base",text:tI.textWhite},secondary:{background:"palette.background.lighter",text:tI.textAttributeLabel}},tL={center:"8px",left:"8px 8px 8px 0",right:"8px 8px 0 8px"},tF=function(e){return e.palette in tS?(0,el.R)(tS[e.palette].text)(e):"inherit"},tT=(0,ei.ZP)(B.xu).attrs(function(e){var t,n;return(0,U.Z)({backgroundColor:e.palette in tS?(0,el.R)(tS[e.palette].background)(e):"inherit",borderRadius:tL[e.alignment],boxShadow:"4",color:tF(e),fontSize:2,lineHeight:(0,el.R)("lineHeights.big")(e),maxWidth:"80%",padding:2,wordWrap:"break-word"},e)})(F||(F=(0,ea.Z)(["\n  .chat-message-link {\n    color: ",";\n    text-decoration: underline;\n  }\n"])),tF),tN=ei.ZP.span.attrs(function(e){return(0,U.Z)({},e)})(T||(T=(0,ea.Z)(["\n  word-wrap: break-word;\n  white-space: break-spaces;\n  line-height: 2;\n  text-indent: 2ch;\n  text-rendering: optimizeLegibility;\n  font-size: ","px;\n  text-align: justify;\n"])),(0,el.R)("fontSizes.2")),tO=(0,ei.ZP)(B.kC).attrs(function(e){return(0,U.Z)({flexDirection:"column",paddingX:3,paddingY:2},e)})(N||(N=(0,ea.Z)(["\n  align-items: ",";\n"])),function(e){var t;return tP[e.alignment]}),tz=(0,ei.ZP)("time").attrs(function(e){return(0,U.Z)({},e)})(O||(O=(0,ea.Z)(["\n  font-size: ","px;\n  float: right;\n  padding-top: 16px;\n"])),(0,el.R)("fontSizes.0")),tA=(0,ei.ZP)("sub")({flex:1,visibility:"hidden"}),tD=new Intl.DateTimeFormat("pt-BR",{timeStyle:"short"}),tM=function(e){try{if(e){var t=new Date(e);return{asIsoString:e,asTime:tD.format(t)}}}catch(n){}return null},tj=["timestamp","renderCaption","children","alignment","palette"],t_=function(e){var t=e.timestamp,n=e.renderCaption,r=e.children,o=e.alignment,a=e.palette,i=(0,em.Z)(e,tj),l=(0,J.useMemo)(function(){return tM(t)},[t]);return J.createElement(tO,(0,U.Z)({"data-testid":"chat-message-root",alignment:o},i),J.createElement(tT,{palette:a,alignment:o,"data-testid":"chat-message-content"},J.createElement(tN,null,"string"==typeof r?J.createElement(tC,{text:r}):r),l&&J.createElement(J.Fragment,null,J.createElement(tA,{"aria-hidden":"true"},l.asTime),J.createElement(tz,{"data-testid":"chat-message-time","aria-label":"Hora da mensagem: ".concat(l.asTime),title:"Hora da mensagem: ".concat(l.asTime),dateTime:l.asIsoString},l.asTime))),n&&J.createElement(B.xu,{py:2},n))};t_.defaultProps={children:"",renderCaption:null,timestamp:""};var tW=(0,J.memo)(t_),tH=n(25164),tG=ei.ZP.div(z||(z=(0,ea.Z)(["\n  background-color: ",";\n  overflow: hidden;\n  padding: 16px;\n\n  & > a {\n    box-shadow: ",";\n    border-radius: ",";\n    align-items: center;\n    padding: 8px 16px;\n\n    div > img {\n      max-height: 83px;\n    }\n  }\n"])),function(e){return(0,el.ow)("white")(e)},(0,el.R)("boxShadows.4"),function(e){return(0,el.R)("radii.default")(e)}),tK={count:0,score:0},tU=function(){return 119},tJ=function(e){var t=e.image,n=e.price,r=e.title,o=e.url;return J.createElement(tG,{"data-testid":"chat-message-product"},J.createElement(tH.Il,{displayMode:"list",installment:{amount:n,paymentMethodDescription:"",quantity:"0",totalAmount:n},title:r,image:t,rating:tK,url:o,allowEmptyRating:!1,hidePrice:!0,hidePriceMode:"hide"}))};tJ.getHeight=tU;var tB=["children","icon"],tq=function(e){var t=e.children,n=e.icon,r=(0,em.Z)(e,tB);return J.createElement(B.kC,r,n&&J.createElement(B.xu,{p:"0 4px"},J.createElement(eo.JO$,{name:n.key,color:n.color,width:16,height:16})),J.createElement(B.xu,null,t))};tq.defaultProps={icon:{color:"text.primary"}};var tV=(0,ei.ZP)(B.zx)(A||(A=(0,ea.Z)(["\n  margin-left: ","px;\n  padding: ","px ","px;\n  min-width: 0;\n  border-radius: ",";\n  white-space: nowrap;\n\n  label {\n    font-size: ","px;\n    text-transform: none !important;\n  }\n"])),(0,el.R)("space.2"),(0,el.R)("space.1"),(0,el.R)("space.3"),(0,el.R)("radii.default"),(0,el.R)("fontSizes.2")),t$=ei.ZP.span(D||(D=(0,ea.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ",";\n  border-style: dashed;\n  border-radius: ",";\n  padding: ","px ","px;\n  white-space: nowrap;\n"])),(0,el.ow)("border.base"),(0,el.R)("radii.default"),(0,el.R)("space.1"),(0,el.R)("space.3")),tY=(0,ei.ZP)(tT)(M||(M=(0,ea.Z)(["\n  display: flex;\n"]))),tX=["alignment","children","couponCode","palette"],tQ=function(e){var t=e.alignment,n=e.children,r=e.couponCode,o=e.palette,a=(0,em.Z)(e,tX),i=function(){navigator.clipboard.writeText(r)};return J.createElement(J.Fragment,null,J.createElement(tW,(0,U.Z)({alignment:t,palette:o},a),n),J.createElement(tO,(0,U.Z)({"data-testid":"chat-message-root",alignment:t},a),J.createElement(tY,{palette:o,alignment:t},J.createElement(t$,null,r),J.createElement(tV,{color:"primary",variant:"contained",onClick:i},"Copiar c\xf3digo"))))};tQ.defaultProps={children:"",renderCaption:null,timestamp:""};var t0=(0,J.memo)(tQ),t1=n(10200),t2=(0,ei.ZP)(B.zx)(j||(j=(0,ea.Z)(["\n  padding: ","px ","px;\n  min-width: 0;\n  border-radius: ",";\n  white-space: nowrap;\n\n  label {\n    font-size: ","px;\n    text-transform: none !important;\n  }\n"])),(0,el.R)("space.1"),(0,el.R)("space.3"),(0,el.R)("radii.default"),(0,el.R)("fontSizes.2")),t3=(0,ei.ZP)(tT)(_||(_=(0,ea.Z)(["\n  display: flex;\n"]))),t4=["alignment","btnTitle","children","deepLink","palette"],t6=function(e){var t=e.alignment,n=e.btnTitle,r=e.children,o=e.deepLink,a=e.palette,i=(0,em.Z)(e,t4);return J.createElement(J.Fragment,null,J.createElement(tW,(0,U.Z)({alignment:t,palette:a},i),r),J.createElement(tO,(0,U.Z)({"data-testid":"chat-message-root",alignment:t},i),J.createElement(t3,{palette:a,alignment:t},J.createElement(t1.Z,{href:o,target:"_blank",underline:!1},J.createElement(t2,{color:"primary",variant:"contained"},n)))))};t6.defaultProps={children:"",renderCaption:null,timestamp:""};var t5=(0,J.memo)(t6),t8=n(28316),t7=(0,ei.ZP)(B.xu)(W||(W=(0,ea.Z)(["\n  > div:first-child {\n    padding-bottom: 0;\n    padding-left: 0;\n    padding-right: 0;\n  }\n"]))),t9=ei.ZP.ul(H||(H=(0,ea.Z)(["\n  list-style: disc;\n  padding-left: ","px;\n"])),(0,el.R)("space.3")),ne=ei.ZP.li(G||(G=(0,ea.Z)(["\n  margin: ","px 0;\n  line-height: ",";\n  font-size: ","px;\n"])),(0,el.R)("space.3"),(0,el.R)("lineHeights.big"),(0,el.R)("fontSizes.2")),nt=function(e){var t=e.label,n=(0,J.useState)(!1),r=(0,ee.Z)(n,2),o=r[0],a=r[1],i=function(){a(function(e){return!e})};return J.createElement(J.Fragment,null,J.createElement(B.rU,{color:"text.primary",onClick:i},t),(0,t8.createPortal)(J.createElement(t7,null,J.createElement(B.Vq,{bg:"background.white",type:"dialog",position:"bottom",showClose:!0,fullScreen:!0,visible:o,onClickOutside:i},J.createElement(B.xu,{p:"2","data-testid":"Dialog-Container"},J.createElement(B.xv,{textAlign:"center",fontWeight:"bold",fontSize:4},"Regulamento Aprova\xe7\xe3o/Reprova\xe7\xe3o"),J.createElement(B.xv,{textAlign:"center",color:"primary",fontSize:3,mb:4,mt:4},"Chat com lojista Magalu"),J.createElement(B.xv,{lineHeight:"big",fontSize:2},"Para garantir a seguran\xe7a e qualidade da informa\xe7\xe3o, todas as mensagens passam por valida\xe7\xe3o."),J.createElement(B.xv,{color:"primary",fontSize:2,mb:3,mt:3},"N\xe3o \xe9 permitido"),J.createElement(t9,null,J.createElement(ne,null,"Troca de informa\xe7\xf5es de contatos diretos (CPF, n\xfamero de telefone, e-mail, perfis em redes sociais e/ou endere\xe7o);"),J.createElement(ne,null,"Conte\xfado ofensivo, preconceituoso e discriminat\xf3rio de qualquer natureza ou que ofendam a imagem do Magalu;"),J.createElement(ne,null,"Enviar mensagens com informa\xe7\xf5es de pagamento;")),J.createElement(B.xv,{color:"primary",fontSize:2,mb:3,mt:3},"Recomendamos"),J.createElement(t9,null,J.createElement(ne,null,"Compartilhamento de produtos apenas do site magazineluiza.com.br;"),J.createElement(ne,null,"Caso tenha recebido informa\xe7\xe3o de mensagem bloqueada, analise os crit\xe9rios acima e envie novamente."))))),document.body))},nn=(0,J.memo)(nt),nr={NOT_MODERATED:"Mensagem em an\xe1lise para aprova\xe7\xe3o.",REJECTED:"Mensagem bloqueada por conter dados sens\xedveis.",WAITING_MODERATION:"Mensagem em an\xe1lise para aprova\xe7\xe3o."},no=function(e){var t=e.label,n=e.type,r=e.onClick;return"readmore"===n?J.createElement(nn,{label:t}):"generic"===n?J.createElement(B.rU,{color:"text.primary",onClick:r},t):null};no.defaultProps={onClick:ey.noop};var na=(0,J.memo)(no),ni={REPURCHASE:{btnTitle:"Comprar",deepLinkId:"deepLinkPDP"},REVIEW:{btnTitle:"Avaliar Produto",deepLinkId:"deepLinkReview"}},nl=function(e){var t=e.id,n=e.alignment,r=e.timestamp,o=e.palette,a=e.contentCaption,i=e.content,l=e.customFields,c=function(e){return e&&e.text?J.createElement(tq,{icon:e.iconId},J.createElement(tw.Z,{fontSize:0},e.text),(null==e?void 0:e.clickAction)&&J.createElement(na,{label:e.clickAction.label,type:e.clickAction.type,onClick:e.clickAction.onClick})):null},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e).find(function(e){return e.startsWith("deepLink")});return t&&Object.values(ni).find(function(e){return e.deepLinkId===t})||null};return J.createElement(tx,{tabIndex:0,key:t,"data-testid":"chat-message-chain-node"},function(){if(l&&l.promoCouponCode)return J.createElement(t0,{alignment:n,timestamp:r,palette:o,renderCaption:c(a),couponCode:l.promoCouponCode},i);var e=u(l);return l&&e?J.createElement(t5,{alignment:n,btnTitle:e.btnTitle,deepLink:l[null==e?void 0:e.deepLinkId],timestamp:r,palette:o,renderCaption:c(a)},i):"product"===o&&l?J.createElement(tJ,{image:l.productImage,title:l.productTitle,url:l.productUrl}):J.createElement(tW,{alignment:n,timestamp:r,palette:o,renderCaption:c(a)},i)}())};nl.defaultProps={contentCaption:null,customFields:void 0,timestamp:""};var nc=(0,J.memo)(nl),nu=new Intl.DateTimeFormat("pt-BR",{day:"numeric",month:"numeric",year:"numeric"}),ns=["customerFollower","infiniteListProps","messages","postMessage","store"],nd=["hasNextItems","loading","onFetchMore"],nm=function(e){var t=e.customerFollower,n=e.infiniteListProps,r=e.messages,o=e.postMessage,a=e.store,i=(0,em.Z)(e,ns),l=n.hasNextItems,c=n.loading,u=n.onFetchMore,s=(0,em.Z)(n,nd),d=tE({messages:r}),m=d.setInfiniteListRef,f=d.onItemsRendered,p=(0,J.useRef)(new Map);p.current=(0,J.useMemo)(function(){var e,t,n;return n=new Map,null==r||r.forEach(function(e){var r;if(!Number.isNaN(Date.parse(r=e.timestamp))){var o=nu.format(new Date(e.timestamp));(void 0===t||t!==o)&&(n.set(e.id,{dateAsFormatPtBr:o}),t=o)}}),n},[r.length]);var h=(0,J.useCallback)(function(e){var t=r[e],n=t.id;if(p.current.has(n)){var o=p.current.get(n).dateAsFormatPtBr;return J.createElement(J.Fragment,null,J.createElement(ta,{tabIndex:0},J.createElement("time",{dateTime:t.timestamp,"aria-label":"Data das mensagens: ".concat(o)},o)),J.createElement(nc,t))}return J.createElement(nc,t)},[r]),g="Chat com ".concat(a.description," .");return J.createElement(ty,(0,U.Z)({flexDirection:"column","data-testid":"chat-message-chain-root"},i),J.createElement(tt,{label:a.description,avatarIcon:"SellerStore",customerFollower:t}),c&&J.createElement(eu,{align:"top"}),J.createElement(eN,{"data-testid":"chat-conversation-list",bg:"background.base"},J.createElement(eT,(0,U.Z)({"aria-live":"polite","aria-relevant":"additions text","aria-label":g,innerTagName:"ol",listRef:m,itemCount:r.length,renderRow:h,onLoadPreviousItems:u,hasPreviousItems:l,loading:c,onItemsRendered:f},s))),J.createElement(tv,{onSubmit:o.onSubmit,loading:o.loading,error:o.error}))};nm.defaultProps={customerFollower:{customerId:"",isFollowing:!1,sellerId:""},infiniteListProps:{hasNextItems:!1,loading:!1,overscanCount:20},postMessage:{error:null,loading:!1,onSubmit:ey.noop},store:{description:""}};var nf=(0,J.memo)(nm),np=function(e){return Array.isArray(null==e?void 0:e.content)?e.content.map(function(e,t){return{data:e,key:t}}).map(function(t){var n=t.data,r=t.key;return Object.prototype.hasOwnProperty.call(n,"kind")?"link"===n.kind?J.createElement(nn,{key:"message-".concat(e.id,"-").concat(r),label:n.label}):n.value:n}):null==e?void 0:e.content},nh=function(e){return({NOT_MODERATED:{color:"text.primary",key:"Clock"},REJECTED:{color:"text.error",key:"SecurityTip"},WAITING_MODERATION:{color:"text.primary",key:"Clock"}})[e.moderation.status]},ng=function(e,t){return"seller"===t?({APPROVED:"secondary",NOT_MODERATED:"secondary",REJECTED:"alert",WAITING_MODERATION:"gray"})[e.status]:"customer"===t?({APPROVED:"primary",NOT_MODERATED:"primary",REJECTED:"alert",WAITING_MODERATION:"primary"})[e.status]:"gray"},nv=function(e){var t;return null!==(t=nr[e.moderation.status])&&void 0!==t?t:null},nx=function(e){var t;return!!(null==e?void 0:null==(t=e.customFields)?void 0:t.find(function(e){return"productId"===e.name}))},ny=function(e){var t;return!!(null==e?void 0:null==(t=e.customFields)?void 0:t.find(function(e){return"promoCouponCode"===e.name}))},nb=function(e){var t,n=Object.values(ni).map(function(e){return e.deepLinkId});return null==e?void 0:null==(t=e.customFields)?void 0:t.some(function(e){return n.includes(e.name)})},nE=function(e){var t;return null==e?void 0:null==(t=e.customFields)?void 0:t.reduce(function(e,t){return e[t.name]=t.value,e},{})},nw=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{alignment:"center",content:e.content,customFields:(0,U.Z)({},e.id?nE(e):{productId:n.id,productImage:n.image,productTitle:n.title,productUrl:"".concat(null==r?void 0:null==(t=r.config)?void 0:t.desktopSiteDomain,"/").concat(n.url)}),id:e.id||n.id,palette:"product"}},nZ=function(e){if(!e)return e;if(nx(e))return nw(e);if(ny(e)||nb(e))return{alignment:"left",content:np(e),contentCaption:{clickAction:null,iconId:null,text:null},customFields:nE(e),id:e.id,palette:"secondary",timestamp:e.whenAt};var t,n,r=null,o=null,a=null,i=null,l=String((null==e?void 0:e.fromUser)?e.fromUser.type:"seller").toLowerCase();switch(l){case"seller":i=ng(e.moderation,"seller"),(o=nv(e))&&(a=nh(e),r={label:"Saiba mais",type:"readmore"});break;case"system":i="alert";break;case"customer":i=ng(e.moderation,"customer"),"REJECTED"===e.moderation.status&&(o=nr.REJECTED,a=nh(e),r={label:"Saiba mais",type:"readmore"});break;default:i="gray"}return{alignment:({customer:"right",seller:"left",system:"center"})[l]||"center",content:np(e),contentCaption:o?{clickAction:r,iconId:a,text:o}:null,id:e.id,palette:i,timestamp:null==e?void 0:e.whenAt}},nk=function(e){var t=e.error,n=e.message,r=e.handler,o=new Date;return{alignment:"right",content:n,contentCaption:{clickAction:{label:"Clique aqui para reenviar.",onClick:r,type:"generic"},iconId:"SecurityTip",text:t},id:"chat-message-id-".concat(o.getTime()),palette:"error",timestamp:o.toISOString()}},nR=n(85942),nC=function(e){var t=(0,J.useState)([]),n=(0,ee.Z)(t,2),r=n[0],o=n[1],a=(0,J.useState)([]),i=(0,ee.Z)(a,2),l=i[0],c=i[1];(0,J.useEffect)(function(){var t,n=Array.isArray(e)?e.map(function(e){return nZ(e)}):[];o(r.reduce(function(e,t){return n.find(function(e){return e.id===t.id})?e:[].concat((0,nR.Z)(e),[t])},[])),c(n)},[JSON.stringify(e)]);var u=(0,J.useCallback)(function(e){o(function(t){return t.filter(function(t){return t.id!==e})})},[o]);return{addMessage:(0,J.useCallback)(function(e){o(function(t){return t.concat(e)})},[o]),messages:l.concat(r),removeMessage:u}},nI=ei.ZP.div(K||(K=(0,ea.Z)(["\n  width: 100%;\n  font-family: 'MagaluTextos', sans-serif;\n"]))),nP=["postMessage"],nS=["result","fetchMore","refetch"];function nL(){nL=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(s){u=function(e,t,n){return e[t]=n}}function d(t,n,r,a){var i,l,c,u,s=Object.create((n&&n.prototype instanceof v?n:v).prototype);return o(s,"_invoke",{value:(i=t,l=r,c=new S(a||[]),u=f,function(t,n){if(u===p)throw Error("Generator is already running");if(u===h){if("throw"===t)throw n;return{value:e,done:!0}}for(c.method=t,c.arg=n;;){var r=c.delegate;if(r){var o=C(r,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(u===f)throw u=h,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);u=p;var a=m(i,l,c);if("normal"===a.type){if(u=c.done?h:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(u=h,c.method="throw",c.arg=a.arg)}})}),s}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=d;var f="suspendedStart",p="executing",h="completed",g={};function v(){}function x(){}function y(){}var b={};u(b,i,function(){return this});var E=Object.getPrototypeOf,w=E&&E(E(L([])));w&&w!==n&&r.call(w,i)&&(b=w);var Z=y.prototype=v.prototype=Object.create(b);function k(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function R(e,t){var n;o(this,"_invoke",{value:function(o,a){function i(){return new t(function(n,i){!function n(o,a,i,l){var c=m(e[o],e,a);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==(0,ef.Z)(s)&&r.call(s,"__await")?t.resolve(s.__await).then(function(e){n("next",e,i,l)},function(e){n("throw",e,i,l)}):t.resolve(s).then(function(e){u.value=e,i(u)},function(e){return n("throw",e,i,l)})}l(c.arg)}(o,a,n,i)})}return n=n?n.then(i,i):i()}})}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError((0,ef.Z)(t)+" is not iterable")}return x.prototype=y,o(Z,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:x,configurable:!0}),x.displayName=u(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,c,"GeneratorFunction")),e.prototype=Object.create(Z),e},t.awrap=function(e){return{__await:e}},k(R.prototype),u(R.prototype,l,function(){return this}),t.AsyncIterator=R,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new R(d(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},k(Z),u(Z,c,"Generator"),u(Z,i,function(){return this}),u(Z,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var nF=function(e){var t,n,r,o,a=e.structure,i=e.store,l=e.product,c=e.conversation,u=e.onReceiveMessages,s=e.static,d=e.user,m=(0,Q.Np)().publish,f=(0,X.Cv)({structure:a}).data,p=(0,J.useRef)(),h=(0,J.useState)(a.route.conversationId||c.id),g=(0,ee.Z)(h,2),v=g[0],x=g[1],y=(0,er.useChatPostMessage)({product:l,sender:d?{fullname:d.name,id:d.id,username:d.email}:d,staticProps:s,structure:a}),b=y.postMessage,E=(0,em.Z)(y,nP),w=(0,er.useChatMessages)({conversationId:v,onReceiveMessages:u,staticProps:s,userId:d.id}),Z=w.result,k=w.fetchMore,R=w.refetch,C=(0,em.Z)(w,nS),I=(0,er.useChatGetLastProduct)({conversationId:v,staticProps:s}).lastProduct,P=(0,er.useChatIsCustomerFollowingSeller)({customerId:d.id,sellerId:i.id}).resultCustomerFollower,S=nC(null!==(t=null==Z?void 0:Z.data)&&void 0!==t?t:[]),L=S.messages,F=S.addMessage,T=S.removeMessage;(0,J.useEffect)(function(){(null==Z?void 0:Z.data)&&l&&!p.current&&I!==l.id&&(F(nw({},l,a)),p.current=l)},[null==Z?void 0:Z.data]);var N,O=(0,J.useState)(null),z=(0,ee.Z)(O,2),A=z[0],D=z[1],M=(0,J.useCallback)((N=(0,e3.Z)(nL().mark(function e(t,n){var r,o,a;return nL().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D(null),r={content:t.message},e.next=5,b(i,v,r,I);case 5:o=e.sent,n&&T(n),x(o.conversationId),F(nZ((0,U.Z)({},o.message,r))),t.ref.resetForm(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),!n&&(null==e.t0?void 0:e.t0.allowRetry)&&(t.ref.resetForm(),a=nk({error:"Houve um erro ao tentar enviar a mensagem.",handler:function(){M(t,a.id)},message:t.message}),F(a)),(null==e.t0?void 0:e.t0.allowRetry)===!1&&D(e.t0.message);case 16:case"end":return e.stop()}},e,null,[[0,12]])})),function(e,t){return N.apply(this,arguments)}),[b,F,T]);return(0,J.useEffect)(function(){if(f){var e,t;m("sellerchat:conversation:onview",{sellerName:i.description,userId:f.id,userIsLogged:f.isLogged,userLocation:(0,U.Z)({},null==a?void 0:null==(e=a.cookies)?void 0:e.location,{zipCode:null==a?void 0:null==(t=a.cookies)?void 0:t.zipCode})})}},[f]),J.createElement(nI,{"aria-busy":C.loading,"data-testid":"MessageChainRoot-Root"},C.error&&J.createElement(ed,{onRetry:R}),null===C.error&&Z&&P&&J.createElement(nf,{"data-testid":"MessageChain-Root",store:i,customerFollower:P,messages:L,postMessage:{error:A,loading:E.loading,onSubmit:M},infiniteListProps:{hasNextItems:!!(null==(n=Z.pagination)?void 0:null==(r=n.links)?void 0:r.next),itemKey:function(e){var t;return null==L?void 0:null==(t=L[e])?void 0:t.id},loading:C.loading,onFetchMore:k}}))};nF.defaultProps={conversation:{},onReceiveMessages:function(){},product:void 0,static:{},store:{}},nF.ssr=!0;var nT=(0,Y.Z)(nF),nN=function(e){var t,n,r,o=e.data,a=e.structure,i=e.static,l=((null==o?void 0:o.product)||{}).seller,c=(0,X.Cv)({structure:a}).data,u=(0,er.useChatConversation)({sellerId:(null==l?void 0:l.id)||(null==(r=a.route)?void 0:r.sellerId),staticProps:i,userId:null==c?void 0:c.id}),s=u.conversation,d=u.loading,m=u.saveConversationAsRead;(0,J.useEffect)(function(){m()},[m]);var f=(0,J.useCallback)(function(e){m((null==e?void 0:e.filter(function(e){var t,n=["REJECTED","APPROVED"].includes(null==(t=e.moderation)?void 0:t.status);return!e.fromUser&&n})).length)},[m]);return(null==c?void 0:c.isLogged)===!1?J.createElement(B.kC,{width:"100%",justifyContent:"center",alignItems:"center"},J.createElement(B.xv,null,"Usu\xe1rio n\xe3o autorizado")):d||(null==c?void 0:c.isLogged)===void 0?J.createElement(B.SX,null):J.createElement(nT,{static:i,structure:a,store:l||{description:(null==s?void 0:null==(t=s.toUser)?void 0:t.fullName)||"",id:null==s?void 0:null==(n=s.toUser)?void 0:n.refKey},conversation:s,product:null==o?void 0:o.product,user:c,onReceiveMessages:f})};nN.defaultProps={data:{},static:{},structure:{}},nN.ssr=!0;var nO=(0,Y.Z)(nN)}}]);
//# sourceMappingURL=2061-93a574308d631f1b.js.map